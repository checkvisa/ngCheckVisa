"use strict";angular.module("ngCheckVisaApp",["ui.router","ui.bootstrap","firebase","ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("main",{url:"/",templateUrl:"views/main.html",controller:"MainCtrl"}).state("about",{url:"/about",templateUrl:"views/about.html"}).state("case",{url:"/case/:id",templateUrl:"views/case.html",controller:"CaseCtrl"})}]),angular.module("ngCheckVisaApp").controller("MainCtrl",["$scope","$state",function(a,b){var c=new Firebase("https://checkvisa.firebaseio.com/cases"),d=new WebSocket("ws://cloud.yhathq.com/richeliteys@gmail.com/models/CheckVisa/");d.onopen=function(){this.send(JSON.stringify({username:"richeliteys@gmail.com",apikey:"RoVGt5VDZfHkdBLx2rre76sg998cD4IuJiYzzNmNp48"}))},a.visaTypes=["B1","B2","F1","F2","H1","H4","J1","J2","L1","L2"],a.visaEntries=["New","Renewal"],a.locations=["BeiJing","ChengDu","Europe","GuangZhou","HongKong","Kolkata","MexicoCity","Montreal","Mumbai","NewDelhi","Others","Ottawa","Quebec","ShangHai","ShenYang","Tijiuana","Toronto","Vancouver"],a.majors=["Aerospace Engineering","Agriculture","Archeology","Architecture","Art","Atmosphere & Marine Science","Bio-engineering","Biochemical Engineering","Bioinformatics / Biostatistics","Biology","Biomedical Engineering","Biophysics Engineering","Business / Management","Chemical Engineering","Chemistry","Civil Engineering","Computer Science/Engineering","Education","Eletrical Engineering","Energy","English","Environmental Science","Finance","Geography","Geology","Industrial Engineering","Information Science/Technology","Law","MBA","Materials Science/Engineering","Mathematics","Mechanical Engineering","Medical Engineering","Medicine / Pathology / Pharmacy","Music","N/A","Neuroscience","Nuclear Engineering","Optic Engieering","Physics","Polymer","Psychology","Social Science","Statistics","Thermal Engineering","Vehicle Engieering"],a.case={checkDate:new Date,visaType:_.first(a.visaTypes),visaEntry:_.first(a.visaEntries),location:_.first(a.locations),major:_.first(a.majors)},a.predict=function(){var e={loc:a.case.location,major:"F1"===a.case.visaType?a.case.major:"",vtype:a.case.visaType,ventry:a.case.visaEntry,byear:moment(a.case.checkDate).get("year"),bmonth:moment(a.case.checkDate).get("month")+1,bday:moment(a.case.checkDate).get("date")};d.send(JSON.stringify(e)),d.onmessage=function(d){if(d.data){var f=angular.fromJson(d.data),g={waitingDays:parseInt(f.result.y[0]),upperInterval:f.result.interval_upper[0],lowerInterval:f.result.interval_lower[0]};g.predictDate=moment().format("l"),g.clearDate=moment(a.case.checkDate).add("days",g.waitingDays).format("l");var h=angular.extend({input:e},{prediction:g}),i=c.push(h,function(a){a&&console.log("Data could not be saved."+a)}),j=i.name();b.go("case",{id:j})}}}}]),function(){angular.module("ngCheckVisaApp").controller("CaseCtrl",["$scope","$state","$firebase",function(a,b,c){a.caseId=b.params.id;var d=new Firebase("https://checkvisa.firebaseio.com/cases/"+a.caseId);a.case=c(d)}])}();